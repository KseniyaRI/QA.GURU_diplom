# Test info

- Name: API проверки >> Проверка фильтрации проектов по клиентскому коду
- Location: /home/runner/_work/QA.GURU_diplom/QA.GURU_diplom/specs/api.spec.js:31:5

# Error details

```
Error: apiRequestContext.get: Fixture { request } from beforeAll cannot be reused in a test.
  - Recommended fix: use a separate { request } in the test.
  - Alternatively, manually create APIRequestContext in beforeAll and dispose it in afterAll.
See https://playwright.dev/docs/api-testing#sending-api-requests-from-ui-tests for more details.
    at ClientController.getClientByCode (/home/runner/_work/QA.GURU_diplom/QA.GURU_diplom/sources/controllers/client.controller.js:14:41)
    at /home/runner/_work/QA.GURU_diplom/QA.GURU_diplom/specs/api.spec.js:33:45
```

# Test source

```ts
   1 | import { BASE_URL } from '../consts/constURL.js';
   2 |
   3 | export class ClientController {
   4 |   constructor(request, authToken) {
   5 |     this.request = request;
   6 |     this.authToken = authToken;
   7 |     this.headers = {
   8 |       "Authorization": `Bearer ${authToken}`,
   9 |       "Accept": "application/json"
  10 |     };
  11 |   }
  12 |
  13 |   async getClientByCode(clientCode) {
> 14 |     const response = await this.request.get(`${BASE_URL}/api/dictionaries/clients?search=${clientCode}`, {
     |                                         ^ Error: apiRequestContext.get: Fixture { request } from beforeAll cannot be reused in a test.
  15 |       headers: this.headers
  16 |     });
  17 |
  18 |     if (response.status() !== 200) {
  19 |       throw new Error(`Ошибка поиска клиента: ${response.status()}`);
  20 |     }
  21 |
  22 |     const body = await response.json();
  23 |     
  24 |     if (!body.data || !body.data.items || body.data.items.length === 0) {
  25 |       throw new Error(`Клиент с кодом ${clientCode} не найден`);
  26 |     }
  27 |     
  28 |     return body.data.items[0];
  29 |   }
  30 | }
```